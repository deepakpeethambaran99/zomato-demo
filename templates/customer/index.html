{% extends 'base.html' %} {% block title %}Zomato Demo {% endblock title%} 

{% block body %}

<div class="container-fluid">
  <div class="row">
    <nav class="navbar shadow-lg navbar-expand-lg navbar-light" style = "color:white; background-color: #ff6161;">
    {% comment %} <a href="/zomatoDemo/login/authenticate"> Go to Site</a> {% endcomment %}
    <div class="col">
        <a class="navbar-brand text-white" style="font-size: 1.8rem;" href="#">Zomato Demo </a>

    </div>    
    <div class="col">
        <div class="float-end">
            
            <div class="dropdown float-start me-2">
                <button class="btn text-white dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                  {{user.get_username}}
                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                  <li><a class="dropdown-item" href="{% url 'orders' %}">Previous Order</a></li>
                  {% if user.status != "customer" %}
                  <li><a class="dropdown-item" href="{% url 'gotodashboard' %}">Dashboard</a></li>
                  {% endif %}
                  <!-- <li><a class="dropdown-item" href="#">Something else here</a></li> -->
                </ul>
              </div>
            {% if user.is_authenticated %}
            <a class="" href="{% url 'logout' %}" style="color:white;  padding-right:40px; font-size:1.6rem; " data-toggle="tooltip" data-placement="top" title="Log out"><i class="fa fa-sign-out" aria-hidden="true"></i></a>
            {% else %}
            <a class="" href="{% url 'login' %}" style="color:white;  padding-right:40px; font-size:1.6rem; " data-toggle="tooltip" data-placement="top" title="sign in"><i class="fa fa-sign-in"></i></a>
            {% endif %}
        </div>
    </div> 
      
    </nav>
  </div>
</div>

<div class="container-fluid">
    <div class="row">
        <div class="col justify-content-center customersite-banner">
          <div class="col-sm-5 d-flex justify-content-center p-lg-5" style="background:#4032328f; 
          margin-left:30%; margin-top:130px;">
                <select class="form-select form-select-lg mb-3" id="restaurant" aria-label=".form-select-lg example">
                  <option selected>Select Restaurant</option>
                  {% if user.status != "restaurant" or user.is_superuser %}
                    {% for restaurant in restaurants %}
                      <option value="{{restaurant.id}}">{{restaurant.restaurant_name}}</option>
                    {% endfor %}
                    {% else %}
                    <option value="{{user.restaurants.id}}">{{user.restaurants.restaurant_name}}</option>

                  {% endif %}


                </select>
          </div>

          <script>

            $(document).ready(function(){
              $("#restaurant").change(function(){
                var restaurant_id = $(this).val();
                //alert(restaurant_id);
                $.ajax(
                  {
                      
                      type:"GET",
                      url: '/zomatoDemo/Home/menulist/'+restaurant_id,
                      success: function( response ) 
                      { 

                        $('#menu').html(response['menu']);
                        $("#menumsg").hide();
                      }
                  });
              });


              
            });
            $(document).on('click', 'button.btnadd',function(){
              var id = $(this).attr('id');
              var res_id = $("#restaurant").val();
              //$(this).parent('td').append("<i class='text-secondary'>Added</i>");
              $.ajax(
                  {
                      type:"GET",
                      url: '{% url "add-to-cart" %}',
                      data: {dish_id: id, res_id: res_id},
                      success: function( response ) 
                      { 
                        // console.log(response['cart']);
                        $('#cart').html(response['cart']);
                        
                      },
                      error: function(jqXHR, textStatus, errorThrown) {
                        console.log(textStatus, errorThrown);
                      }
                  });
              
            });
            
          </script>
        
      </div>
    </div>
</div>



<div class="container-fluid">
    <div class="row">

      {% if messages %} {% for message in messages%}
      <div class="{{message.tags}} text-center mt-3">
        <h5>{{message}}</h5>
      </div>
      {% endfor %} {% endif %}



        <div class="col p-5">
          
            <h1 class="display-5">Menu</h1>
            <table class="table table-borderless" id="menu">
              {% include 'customer/menu.html' %}
            </table>
            
            <p class="text-danger text-center" id="menumsg"><i>Please select restaurant from aboven to show menu.</i></p>
        </div>

        <div class="col-4 border-start p-5 m-5" id="cart">
          {% include 'customer/cart.html' %}
        </div>
    </div>
</div>
{% endblock body %}
